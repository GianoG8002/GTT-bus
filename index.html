<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bus GTT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  <body>
    <h1>Bus GTT</h1>
    <div class="container">
        <table>
            <tr>
                <td colspan="4">yeah</td>
            </tr>
            <tr>
                <td colspan="4">
                    <div class="row">
                        <h2>Inserisci fermata</h2>
                        <input type="text" name="" id="num">
                        <button type="button" onclick="fermata()">Skibidi</button>
                    </div>
                    <div class="row" id="lista">
                        <div class="col" id="base">
                            <h2 id="linea">linea</h2>
                            <h2 id="orario">ora</h2>
                        </div>
                    </div>
                </td>
            </tr>
        </table>        
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        function fermata(){
            fetch("https://gpa.madbob.org/query.php?stop=" + document.getElementById("num").value)
            .then(x => x.json())
            .then(y => mostra(y));
        }

        function aggiungi(linea, orario){
            let div = document.createElement("div");
            let p1 = document.createElement("p");
            let p2 = document.createElement("p");
            p1.innerHTML = linea;
            p2.innerHTML = orario;
            div.appendChild(p1);
            div.appendChild(p2);
            div.classList.add("col");
            document.getElementById('lista').appendChild(div);
        }

        function mostra(lista){            
            document.getElementById('lista').innerHTML = "";
            aggiungi(lista[0].line, lista[0].hour);
            aggiungi(lista[1].line, lista[1].hour);
        }       
    </script>
  </body>
</html>